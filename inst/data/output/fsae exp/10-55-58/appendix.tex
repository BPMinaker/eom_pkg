\chapter{Equations of Motion}
The equations of motion are of the form
\[
\begin{bmatrix} {\textbf I} & {\bm 0} \\ {\bm 0} & {\textbf M}\end{bmatrix}
\begin{Bmatrix} \dot{\bm p}\\ \dot{\bm w}\end{Bmatrix}
+\begin{bmatrix} {\textbf V} & -{\textbf I} \\ {\textbf K} & {\textbf C} \end{bmatrix}
\begin{Bmatrix} {\bm p}\\ {\bm w}\end{Bmatrix}
=\begin{Bmatrix} {\bm 0} \\ {\bm f} \end{Bmatrix}
+\begin{bmatrix} {\bm 0}\\ {\textbf F}\end{bmatrix}
\begin{Bmatrix} {\bm u}\end{Bmatrix}
\]
The mass matrix of the system is
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/mass_matrix.out}
\end{center}
\end{footnotesize}
The damping matrix is
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/damping_matrix.out}
\end{center}
\end{footnotesize}
The stiffness matrix is
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/stiffness_matrix.out}
\end{center}
\end{footnotesize}
The velocity matrix is
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/velocity_matrix.out}
\end{center}
\end{footnotesize}
The input force matrix is
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/forcing_matrix.out}
\end{center}
\end{footnotesize}
The system is subject to constraints
\[
\begin{bmatrix}
\textbf{J}_\textrm{h} & {\bm 0}\\-{\textbf J}_\textrm{h}{\textbf V} & {\textbf J}_\textrm{h}\\ {\bm 0} & {\textbf J}_\textrm{nh}
\end{bmatrix}
\begin{bmatrix}
\dot{\bm p} & {\bm p} \\ \dot{\bm w} & {\bm w}
\end{bmatrix}
=\begin{bmatrix}
{\bm 0} & {\bm 0}\\{\bm 0} & {\bm 0}\\{\bm 0} & {\bm 0}
\end{bmatrix}
\]
\pgfplotstableset{
begin table=\begin{longtable},
end table=\end{longtable}}
\begin{footnotesize}
\begin{center}
\pgfplotstabletypeset[
columns={[index]0,[index]1,[index]2,[index]0,[index]1,[index]2,[index]0,[index]1,[index]2},
display columns/0/.style={select equal part entry of={0}{3}},
display columns/1/.style={select equal part entry of={0}{3}},
display columns/2/.style={select equal part entry of={0}{3}},
display columns/3/.style={select equal part entry of={1}{3}},
display columns/4/.style={select equal part entry of={1}{3}},
display columns/5/.style={select equal part entry of={1}{3}},
display columns/6/.style={select equal part entry of={2}{3}},
display columns/7/.style={select equal part entry of={2}{3}},
display columns/8/.style={select equal part entry of={2}{3}},
]{unformatted/jacobian_matrix.out}
\end{center}
\end{footnotesize}
There are 8 degrees of freedom.\\

\noindent The full state space equations:
\[
\begin{bmatrix}
{\textbf E} & {\bm 0} \\ {\bm 0} & {\textbf I}
\end{bmatrix}
\begin{Bmatrix}
\dot{\bm x}\\ {\bm y}\end{Bmatrix}
=\begin{bmatrix}
\textbf{A} & \textbf{B} \\ \textbf{C} & \textbf{D}
\end{bmatrix}
\begin{Bmatrix}
{\bm x}\\ {\bm u}\end{Bmatrix}
\]
\begin{tiny}
\[
\begin{bmatrix}
{\textbf A} & {\textbf B} \\ {\textbf C} & {\textbf D}
\end{bmatrix} =
\left[\begin{array}
{@{}cccccccccccccccc|cc@{}}
   -0 & -0.11711 &    -0 &    -0 & -0.35302 & -0.09832 & 0.24675 & -0.36894 & -0.02193 & 0.29442 & 0.24848 & -0.26691 & -0.33845 & 0.08688 & 0.55854 & 0.02781 &     0 &     0 \\
-613.65 & -346.5 & -386.74 & -6535.8 & -1159.8 & -1919.4 & -298.21 & 445.32 & -72.642 & 1457.2 & -679.81 & -1337.3 & -101.23 & -767.15 & -1540.4 & -4491.1 & 17142 & -7.2312 \\
   -0 & -0.07009 &    -0 &    -0 & -0.42821 & 0.75136 & -0.06475 & 0.15051 & -0.02394 & 0.03656 & 0.03579 & 0.04578 & 0.26685 & -0.26127 & 0.17363 & -0.21317 &     0 &     0 \\
   -0 & 0.6519 &    -0 &    -0 & 0.27908 & 0.11638 & -0.01859 & -0.42594 & 0.08304 & 0.06686 & 0.03729 & 0.18892 & -0.15004 & -0.42481 & 0.08758 & -0.20668 &     0 &     0 \\
1181.6 & -695.98 & 5264.5 & -794.1 & 1901.9 & 2168.9 & 2630.1 & -1347.1 & -5170.9 & -3228.6 & 1209.7 & 664.68 & -1363.2 & 2566.7 & -454.33 & -2605.2 & 13817 & 15.951 \\
-5971 & 2032.5 & -4154.2 & -2242.6 & -1529.6 & -1070.4 & 1946.7 & 815.14 & 1660.3 & -304.52 & -943.47 & -3296.6 & 728.2 & 901.22 & -1436.5 & -3721.7 & 6907.1 & 76.449 \\
3555.8 & -940.51 & 1213.3 &  1873 & 509.1 & 232.5 & -1637.5 & -348.7 & 159.99 & 680.29 & 108.81 & 1639.2 & 69.997 & -1011.8 &  1086 & 3031.6 & -7761.2 & 110.09 \\
8610.4 & -3168.2 & 5099.4 & 4477.7 & 2482.9 & 1801.3 & -3355.2 & -939.48 & -2279.4 & 743.07 & 2239.3 & 5788.7 & -1563.9 & -1467 & 2400.6 &  6728 & -15457 & -152.37 \\
563.13 & 175.54 & -1676.8 & 315.47 & -774.79 & -956.77 & -1243.7 & 296.16 & 2027.3 & 1298.8 & -848.94 & -362.14 & 825.04 & -1203.8 & 339.26 & 1258.8 & -5108 & 98.432 \\
-10607 & 3470.2 & -2437.1 & -4745.6 & -1209.2 & 47.782 & 6599.4 & 217.16 & -1601.6 & -3902.8 & -1065.8 & -6153.6 & 380.02 & 4317.1 & -3261.1 & -9957.4 & 27212 & -119.53 \\
-10515 & 4386.7 & -3673.5 & -1438.4 & -1410.1 & 308.47 & 6773.1 & -78.68 & -243.43 & -4468 & -2001.5 & -6960.3 &  1554 & 4404.3 & -2466.4 & -7798.1 & 18220 & 139.19 \\
10993 & -2463.8 & -2183 & -1618 & -2357.8 & -4675.4 & -8330.2 & 315.31 & 6076.3 & 7393.2 & -3162.8 & 1463.3 & 2518.3 & -7184.4 & 1922.5 & 5847.7 & -12712 & -32.852 \\
838.72 & 2184.6 & -3392.8 & -821.31 & -2514.5 & -2554.9 & 687.09 &  -855 & 3057.5 & 116.2 & -4753.9 & -5640.4 & 3761.5 & -688.29 & -413.28 & -2523.2 & 9065.3 & -31.58 \\
-4285.2 &  1886 & -2481 & -1409.7 & -1299.3 & -853.58 & 2139.1 & 256.36 & 1088.1 & -792.04 & -1504.8 & -3483.7 &  1086 & 995.03 & -1238.9 & -3718.1 & 8795.9 & -345.75 \\
-10957 & 2525.9 & -3978.7 & -3915.3 & -1152.5 & -178.18 & 3962.8 & 1519.5 & 111.33 & -1562.1 & 737.02 & -3253.9 & -733.51 & 2635.6 & -2598.9 & -6451.6 & 12623 & -15.062 \\
2259.4 & -962.5 & 3180.2 & 2738.7 &  1674 & 1847.2 & 157.44 & -666.42 & -2222.6 & -1257.9 & 1382.6 & 2275.8 & -1005.5 & 763.16 & 866.94 & 2171.8 & -4959.4 & -44.395 \\
\hline
& \\[\dimexpr-\normalbaselineskip+2pt]
-0.1232 & -0.01795 & 0.31602 & 0.0391 & 0.07852 & 0.09387 & 0.07858 & -0.00892 & 0.01237 & -0.03385 & 0.01546 & 0.04504 & -0.03354 & 0.06688 & 0.02166 & 0.04763 &     0 &     0 \\
0.04809 & -0.06784 & 0.10656 & 0.23013 & -0.04133 & -0.10207 & -0.0327 & 0.05558 & -0.00966 & 0.13477 & 0.01403 & -0.00659 & -0.06912 & -0.05293 & -0.10722 & -0.28909 &     0 &     0 \\
\end{array}\right]
\]
\[
\textbf{E}=
\begin{bmatrix}
    1 &     0 &     0 &    -0 &    -0 &     0 &     0 &     0 &     0 &    -0 &    -0 &    -0 &     0 &     0 &    -0 &    -0 \\
    0 & 2.2883 &    -0 &     0 & -1.4052 & 3.3069 & -0.9808 & 1.578 & -0.29413 &  0.45 & -0.60884 & 2.5764 & 3.1878 & -0.02343 & 1.3674 & -1.9883 \\
    0 &    -0 &     1 &    -0 &    -0 &     0 &     0 &     0 &     0 &     0 &     0 &     0 &    -0 &     0 &    -0 &    -0 \\
   -0 &     0 &    -0 &     1 &    -0 &    -0 &     0 &     0 &    -0 &     0 &     0 &    -0 &    -0 &    -0 &    -0 &    -0 \\
   -0 & -1.4052 &    -0 &    -0 & 4.6238 & -6.2892 & 0.55533 & -3.0006 & 0.31688 & -0.05597 & 0.94316 & -5.0658 & -6.0009 & 1.4704 & -2.3575 & 3.5568 \\
    0 & 3.3069 &     0 &    -0 & -6.2892 & 19.264 & -3.6063 & 7.7986 & -1.0077 & 0.1126 & -1.5927 & 7.9188 & 13.147 & -5.6729 & 3.7936 & -8.1011 \\
    0 & -0.9808 &     0 &     0 & 0.55533 & -3.6063 & 4.3377 & -2.2916 & 0.12125 & -0.07808 & 1.0805 & -1.6027 & -2.8356 & -1.8792 & -0.83227 & 1.9851 \\
    0 & 1.578 &     0 &     0 & -3.0006 & 7.7986 & -2.2916 & 7.6641 & -2.1395 & 0.86438 & -3.6717 & 4.1552 & 5.8568 & 0.05633 & 0.49498 & -2.5469 \\
    0 & -0.29413 &     0 &    -0 & 0.31688 & -1.0077 & 0.12125 & -2.1395 & 2.7061 & -1.7856 & 1.2867 & 0.45371 & -0.4178 & -1.0828 & 0.04931 & -0.60299 \\
   -0 &  0.45 &     0 &     0 & -0.05597 & 0.1126 & -0.07808 & 0.86438 & -1.7856 & 4.0592 & -0.22036 & -1.2821 & 0.17241 & 2.2912 & 0.89829 & 0.7481 \\
   -0 & -0.60884 &     0 &     0 & 0.94316 & -1.5927 & 1.0805 & -3.6717 & 1.2867 & -0.22036 & 3.8922 & -2.0826 & -1.6036 & -1.5509 & 0.24827 & 0.35963 \\
   -0 & 2.5764 &     0 &    -0 & -5.0658 & 7.9188 & -1.6027 & 4.1552 & 0.45371 & -1.2821 & -2.0826 & 10.674 & 9.3935 & -0.92743 & 3.1054 & -5.8582 \\
    0 & 3.1878 &    -0 &    -0 & -6.0009 & 13.147 & -2.8356 & 5.8568 & -0.4178 & 0.17241 & -1.6036 & 9.3935 & 13.307 & -2.1353 & 3.8886 & -7.2764 \\
    0 & -0.02343 &     0 &    -0 & 1.4704 & -5.6729 & -1.8792 & 0.05633 & -1.0828 & 2.2912 & -1.5509 & -0.92743 & -2.1353 & 9.2266 & 0.20518 &     2 \\
   -0 & 1.3674 &    -0 &    -0 & -2.3575 & 3.7936 & -0.83227 & 0.49498 & 0.04931 & 0.89829 & 0.24827 & 3.1054 & 3.8886 & 0.20518 & 3.2931 & -2.5932 \\
   -0 & -1.9883 &    -0 &    -0 & 3.5568 & -8.1011 & 1.9851 & -2.5469 & -0.60299 & 0.7481 & 0.35963 & -5.8582 & -7.2764 &     2 & -2.5932 & 5.9592 \\
\end{bmatrix}
\]
\end{tiny}
