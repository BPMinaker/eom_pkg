clear all

lambda1r=[ ...
3.13164324790656;
3.52696170990070;
2.68234517512745;
1.70675605663975;
0.41325331521125;
-0.77534188219585;
-1.52644486584142;
-2.13875644258362;
-2.69348683581097;
-3.21675402252485;
-3.72016840437287;
];

lambda1i=[ ...
0;
0.80774027519930;
1.68066296590675;
2.31582447384325;
3.07910818603206;
4.46486771378823;
5.87673060598709;
7.19525913329805;
8.46037971396931;
9.69377351531791;
10.90681139476287;
];


lambda3=[ ...
-3.13164324790656;
-3.13423125066578;
-3.07158645641514
-2.63366137253667;
-1.42944427361326;
-0.32286642900409;
-0.00406690076970;
0.10268170574766;
0.14327879765713;
0.15790184030917;
0.16105338653172;
];

lambda4=[ ...
-5.53094371765393;
-7.11008014637442;
-8.67387984831735;
-10.35101467245920;
-12.15861426576447;
-14.07838969279822;
-16.08537123098026;
-18.15788466125262;
-20.27940894394569;
-22.43788559040858;
-24.62459635017404;
];


lambda1=(lambda1r+lambda1i*1i);
lambda2=(lambda1r-lambda1i*1i);
lambda2(1)=5.53094371765393;

format long;

lambda=[ ...
lambda1';
lambda2';
lambda3';
lambda4';
]


% str='';
% for i=1:11
% 	for j=1:4
% 		str=[str sprintf('%4.14f %+4.14fi, ', real(lambda(j,i)),imag(lambda(j,i)))];
% 	end
% 	str=[str '\n'];
% end
% 
% file=fopen('lambda.txt', 'w');
% fprintf(file,str);
% fclose(file);


for i=1:11
	sys=run_eom('input_ex_bicycle_rider',i-1,'quiet');
	format long
	tic
	res(:,i)=pole(sys);
	toc
	resmin(:,i)=pole(minreal(sys,1e-5));
	
	error=norm(sort([lambda(:,i);0;0])-sort(res(:,i)))
	errormin=norm(sort(lambda(:,i))-sort(resmin(:,i)))

end






